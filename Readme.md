# illustrator-ruby

Adobe Illustrator 上でルビ（振りがな）を振るためのスクリプトです。

Illustrator は標準ではルビ機能に対応していませんが、本スクリプトを使用することで、テキストベースの指定によって一括でルビを振ることが可能となります。

[サンプル](sample.md) - [FAQ](faq.md)

[解説記事](https://) - スクリプトの使用方法や、ルビの基本に関して解説しています。

## 主な仕様
- ポイントテキスト、エリア内テキストに対して、縦／横組みいずれの場合もルビを振ることができます。
  - パス上テキストは横組みのみ対応しています。この際、ルビは水平に配置されます（パスに沿ってルビが回転されることはありません）。
  - スレッドテキスト、パス上テキスト（縦組み）には対応していません。
- ルビは親文字のテキストフレームとは別に新たなポイントテキストとして配置され、グループ化された状態で生成されます。
- Adobe Illustrator 2022 (26.3.1) で動作確認をしています。

## 使用方法
### ルビの記述
`[親文字|ルビ]` の形で記述します。  
`[親文字|ルビ1/ルビ2/...]` と記述した場合は、ルビ 1 が親文字の 1 文字目に対応します。  
`[親文字|上側ルビ|下側ルビ]` と記述した場合は、上側・下側の両サイドにルビを付与します。

```
# モノルビ（2つの処理結果は同一）
[筑|つく][波|ば][大|だい][学|がく][情|じょう][報|ほう][学|がく][群|ぐん]
[筑波大学|つく|ば|だい|がく][情報学群|じょう|ほう|がく|ぐん]

# グループルビ
[筑波|つくば][大学|だいがく][情報|じょうほう][学群|がくぐん]
[筑波大学|つくばだいがく][情報学群|じょうほうがくぐん]
```



### 詳細設定
スタイルに関する詳細設定が可能です。`(プロパティ|値)` の形で指定します。  
特に指定しない場合は既定値が適用されます。既定値に戻す場合は値として `base` を指定します。

- align
  - ルビの揃え位置
  - 値：`kata` 肩付き, `naka` 中付き, `jis` JISルール(1-2-1)
  - 既定値：`jis`
  - 記述例：`(align(kata)[肩付[かたつ]き`

- size
  - ルビのサイズ
  - 値：数値 + 単位
  - 規定値：親文字の 1/2 サイズ
  - 記述例：`(font(4H)寸法[すんぽう]`

- font
  - ルビのフォント
  - 値：指定するフォントの PostScript 名
  - 規定値：親文字のフォント
  - 記述例：`(font(KozGoPro-H)小塚[こずか]ゴシック`

- shinshutu
  - ルビが親文字に収まらない場合に、前後のアキを調整する
  - 値：

- narrow
  - ルビが親文字に収まらない場合に、水平方向（平体、縦組みでは垂直方向）の縮尺の自動調節
  - 値：`true` 調節する, `false` 調節しない
  - 既定値：`false`
  - 記述例：`(narrow(false)[標準[デファクト・スタンダード]`

- sutegana
  - 捨て仮名[^1]への自動変換
  - 値：`true` 変換する, `false` 変換しない
  - 規定値：`true`
  - 記述例：`(sutegana(true)捨[す]て仮名[がな]`

- 寸法の指定には以下の単位を指定できます。
  - pt, cm, mm, Q／H, %, px（1px = 0.75pt）
- PostScript 名はフォント名やファミリー名とは異なります。例えば、ヒラギノ角ゴProN W3 を使用したい場合は `HiraKakuProN-W6` と指定する必要があります。

### スクリプトの実行
1. 2つのテキストフレームを用意します。
2. 片方のテキストに対して、先述した記法を用いてルビや詳細設定を指定します。
3. 2 で編集したルビを指示するテキストを、`base` を含む名前にリネームします。
4. もう一方の、ルビを振るテキストを、`finish` を含む名前にリネームします。
5. 2 つのテキストフレームを選択します。
6. Illustrator 上で `dist/ruby.jsx` を実行します。
  - `dist/ruby.jsx` ファイルをワークスペース内にドラッグ・アンド・ドロップすることでスクリプトが実行されます。


## 注意事項
- MIT ライセンスに従って、自由に使用・再配布等を行うことができます。
- 本スクリプトは無保証です。本スクリプトの仕様を原因とする損失や損害に関して、一切の責任を負いかねます。


## Contribution
TypeScript で記述され、Webpack + ts-loader を用いて ES3 相当のスクリプトに変更しています[^2]。  
Babel が出力するソースコードを Illustrator が搭載するインタプリタが解釈できなかったため、必要に応じて Polyfill を `./src/polyfill.ts` に手動で記述しています。

### Build
```bash
yarn  # Install dependencies
yarn dev # Develop
yarn build  # Build
```


## License
Copyright (c) 2022 いなにわうどん.
This software is released under the MIT License, see LICENSE.

[^1]: 捨て仮名：とは、を指します
[^2]: Adobe Illustrator に搭載されているインタプリタは、ECMAScript 3 に相当する JavaScript を解釈します。

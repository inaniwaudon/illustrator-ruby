# 詳細設定
ルビのスタイル（揃え位置・サイズ・フォント等）に関して詳細設定を行います。`(プロパティ|値)` の形で指定します。  

詳細設定を指定しない場合は既定値が適用されます。明示的に既定値に戻す場合は `base` を値として指定します。

## プロパティ一覧

### align

|項目|説明|
|---|---|
|概要|親文字に対するルビの**文字揃え**の位置|
|値|`kata`：肩付き, `naka`：中付き, `jis`：JIS（1-2-1）ルール, `shita`：右／下揃え|
|既定値|`jis`|
|記述例|`(align\|kata)[肩付\|かたつ]き`|

### size

|項目|説明|
|---|---|
|概要|ルビの**サイズ**|
|値|数値 + 単位|
|規定値|親文字の 1/2 サイズ|
|記述例|`(font\|4H)[寸法\|すんぽう]`|

### font

|項目|説明|
|---|---|
|概要|ルビに使用する**フォント**|
|値|指定するフォントの PostScript 名|
|規定値|親文字のフォント|
|記述例|`(font\|KozGoPro-H)[小塚\|こずか]ゴシック`|

### overflow

|項目|説明|
|---|---|
|概要|ルビが親文字に収まらない場合にどのような処理を行うか（詳細は「進入処理に関する説明」を参照）|
|値|`shinyu`: 進入処理[^shinyu]を実施する, `narrow`：長体・平体にして親文字にルビを収める, `false`：調節しない|
|既定値|`shinyu`|
|記述例|`(shinyu\|false)[標準\|デファクト・スタンダード]`|

### sute

|概要|説明|
|---|---|
|概要|**捨て仮名**[^sutegana]から大文字への自動変換を実施するか|
|値|`true`：変換する, `false`：変換しない|
|既定値|`true`|
|記述例|`(sute\|true)断捨離\|だんしゃり]`|

## 寸法の指定
寸法の指定には以下の単位を指定できます。
- pt, cm, mm, Q・H, %, px
- 1px は 0.75pt として算出されます。

## フォント名の指定
フォントの指定に利用する PostScript 名（PSName）はフォント名やファミリー名とは異なります。例えば、ヒラギノ角ゴProN W3 を使用したい場合は `HiraKakuProN-W6` と記述する必要があります。

PostScript 名 はフォントベンダのサイトや、Adobe Acrobat 等のソフトウェアを用いて確認することが可能です。

- モリサワ：[MORISAWA PASSPORT収録書体名一覧](https://www.morisawa.co.jp/support/download/3697)
- フォントワークス：https://lets-site.jp/burger_editor/burger_editor/dl/32__TEVUUw-D-.pdf
- SCREEN（ヒラギノ）：[PostScriptフォント名一覧](https://www.screen.co.jp/ga_product/sento/support/QA/ss_psname.html)

## 進入処理に関する説明
ルビの文字列が親文字よりも長く、親文字の上にルビが収まりきらない場合、以下の2通りの処理を行うことができます。

1. **進入処理**：親文字の前後の文字クラス[3]に応じて、ルビを前後の文字に掛け（進入）、それでも収まらない場合は親文字の前後にアキを入れる。
2. **長体・平体**：ルビの水平方向（縦組みの場合は垂直方向）の縮尺を縮め、親文字の長さにルビを収める。
3. **調節しない**：調節を行わない。ルビが前後の親文字やルビに掛かる恐れがある。

特に、1. 進入処理に関する説明を以下に述べます。

- 熟語ルビ：JLReq に従って適切に処理を行う。
- 肩付き：後方向への進入を試みる。ルビが 4 文字以上で親文字に収まりきらないか、後方向への進入が叶わない場合は、前方向への進入を試みる。アキを挿入する際は、後方向にのみ挿入する。
- 中付き：両側への進入を試みる。片側のみしか進入できない場合は、片側のみ進入させる。アキを挿入する際は、前後に均等にアキを挿入する。
- 1-2-1（JIS）：中付きと同様に進入処理を行う。アキを挿入する際は 1 : 2 : 1 となるように配分する（親文字の前後のアキが 1, 親文字間のアキが 2 となる）。

[^shinyu]: 進入処理：ルビを親文字と隣接した文字に掛けること。
[^sutegana]: 捨て仮名：拗音や促音等に使用される、小さな仮名（ぁぃぅぇぉっゃゅょ等）のこと。
